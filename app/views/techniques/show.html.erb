<header class="technique__header">
  <h1 class="technique__heading"><%= @technique.name %></h1>

  <% if @technique.user == current_user %>
    <div class="technique__controls">
      <%= link_to "Edit", edit_technique_path(@technique), class: "button button--small" %>
      <%= link_to "Delete", @technique, method: :delete, class: "button button--small", data: { confirm: "Sure?" } %>
    </div>
  <% end %>
</header>

<%= simple_format @technique.description %>

<p>
  Category: <%= @technique.category.name %><br>
  Belt: <%= @technique.belt.pretty_print %>
</p>

<div class="notes">
  <h2>Notes</h2>

  <% if @technique.user == current_user %>
    <button class="notes__new-button">+</button>

    <%= simple_form_for [@technique, @new_note] do |f| %>
      <%= f.input :text, label: "Note text" %>
      <%= f.button :submit %>
    <% end %>
  <% end %>

  <div class="notes__list">
    <% if @notes.present? %>
      <ul>
        <% @notes.each do |note| %>
          <li>
            <%= simple_format note.text %>

            <p class="notes__list__timestamps">
              Created <%= note.created_at.to_formatted_s(:short) %>
              (<%= time_ago_in_words note.created_at %> ago)
            </p>

            <% if @technique.user == current_user %>
              <div class="notes__list__controls">
                <%= link_to "Edit note", edit_technique_note_path(@technique, note), class: "button button--small" %>
                <%= link_to "Delete note", technique_note_path(@technique, note), method: :delete, class: "button button--small", data: { confirm: "Sure?" } %>
              </div>
            <% end %>
          </li>
        <% end %>
      </ul>
    <% else %>
      There are no notes for this technique
    <% end %>
  </div>
</div>
